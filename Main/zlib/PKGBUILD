# -*- mode: sh -*-
pkgname=zlib
pkgver=1.2.11
pkgrel=1
arch=('x86_64')
license=('custom')
url="https://www.zlib.net/"
pkgdesc="contains compression and decompression routines used by some programs"
depends=('glibc')
source=("https://zlib.net/zlib-${pkgver}.tar.xz")
groups=('lfs-base')

prepare() {
  cd ${srcdir}/zlib-${pkgver}
  ./configure --prefix=/usr
}

build() {
  cd ${srcdir}/zlib-${pkgver}
  make
}

check() {
  cd ${srcdir}/zlib-${pkgver}
  make test
}

package_zlib() {
  pkgdesc='Compression library implementing the deflate compression method found in gzip and PKZIP'

  cd ${srcdir}/zlib-$pkgver
  make install DESTDIR=${pkgdir}

  install -v -d -m755 ${pkgdir}/lib
  mv -v ${pkgdir}/usr/lib/libz.so.* ${pkgdir}/lib
  ln -sfv ../../lib/$(readlink ${pkgdir}/usr/lib/libz.so) ${pkgdir}/usr/lib/libz.so
}

md5sums=('85adef240c5f370b308da8c938951a68')
