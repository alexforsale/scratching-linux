# -*- mode:sh -*-
pkgname=tzdata
pkgver=2018e
_tzcode=2018e
_tzdata=2018e
pkgrel=1
pkgdesc="Sources for time zone and daylight saving time data"
arch=('any')
url="http://www.iana.org/time-zones"
license=('GPL')
options=('!emptydirs')
source=(https://www.iana.org/time-zones/repository/releases/tzcode${_tzcode}.tar.gz
        https://www.iana.org/time-zones/repository/releases/${pkgname}${_tzdata}.tar.gz)
timezones=('africa' 'antarctica' 'asia' 'australasia'
           'europe' 'northamerica' 'southamerica'
           'pacificnew' 'etcetera' 'backward'
           'systemv' 'factory')
groups=('lfs-base')

build() {
  cd $srcdir
  make 
}

package() {
  cd ${srcdir}
  # install tzcode stuff
  make DESTDIR="${pkgdir}" install

  # install tzdata stuff
  ./zic -d ${pkgdir}/usr/share/zoneinfo ${timezones[@]}
  ./zic -d ${pkgdir}/usr/share/zoneinfo/posix ${timezones[@]}
  ./zic -d ${pkgdir}/usr/share/zoneinfo/right -L leapseconds ${timezones[@]}
  
  ./zic -d ${pkgdir}/usr/share/zoneinfo -p America/New_York
  install -m444 -t ${pkgdir}/usr/share/zoneinfo iso3166.tab zone1970.tab zone.tab
  
  # cleanup
  rm "${pkgdir}/etc/localtime"
}

md5sums=('c4d7df0fff7ba5588b32c5f27e2caf97'
         '97d654f4d7253173b3eeb76a836dd65e')
